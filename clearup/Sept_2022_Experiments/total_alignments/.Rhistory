for (line in 1:nrow(branch_bounds)) {
#curr_ali<-read.FASTA(filename)
x<-as.data.frame(as.matrix(dist.dna(curr_ali,model="JC69")))
prefix_i<-branch_bounds$start[line]
prefix_j<-branch_bounds$end[line]
curr_rows<-grep(prefix_i, rownames(x))
curr_cols<-grep(prefix_j,colnames(x))
#print(data.frame(prefix=c(prefix_i,prefix_j),coords=c(curr_rows,curr_cols)))
curr_comp<-x[curr_rows,curr_cols]
dist_vect<-c(dist_vect,curr_dist)
}
print(dist_vect)
}
x
y
x == y
row_names
y
x
y
col_names<-c()
for (i in 1:length(run_alifiles)) {
filename<-run_alifiles[i]
print(filename)
curr_ali<-read.FASTA(filename)
splitted_filename<-strsplit(filename,split="_")[[1]]
gene_id<-splitted_filename[grep("gene-",splitted_filename)]
col_names<-c(col_names,gene_id)
row_names<-paste(branch_bounds$start,"<->",branch_bounds$end,sep="")
dist_vect<-c()
for (line in 1:nrow(branch_bounds)) {
#curr_ali<-read.FASTA(filename)
x<-as.data.frame(as.matrix(dist.dna(curr_ali,model="JC69")))
prefix_i<-branch_bounds$start[line]
prefix_j<-branch_bounds$end[line]
curr_rows<-grep(prefix_i, rownames(x))
curr_cols<-grep(prefix_j,colnames(x))
#print(data.frame(prefix=c(prefix_i,prefix_j),coords=c(curr_rows,curr_cols)))
curr_comp<-x[curr_rows,curr_cols]
dist_vect<-c(dist_vect,curr_dist)
}
print(dist_vect)
}
y
y
x
x[,4]
x[,21]
colnames(x)[21]
colnames(x)[22]
colnames(x)[18]
colnames(x)[19]
x[,19]
col_names<-c()
for (i in 1:length(run_alifiles)) {
filename<-run_alifiles[i]
print(filename)
curr_ali<-read.FASTA(filename)
splitted_filename<-strsplit(filename,split="_")[[1]]
gene_id<-splitted_filename[grep("gene-",splitted_filename)]
col_names<-c(col_names,gene_id)
row_names<-paste(branch_bounds$start,"<->",branch_bounds$end,sep="")
dist_vect<-c()
for (line in 1:nrow(branch_bounds)) {
#curr_ali<-read.FASTA(filename)
x<-as.data.frame(as.matrix(dist.dna(curr_ali,model="JC69")))
print(x[,21])
prefix_i<-branch_bounds$start[line]
prefix_j<-branch_bounds$end[line]
curr_rows<-grep(prefix_i, rownames(x))
curr_cols<-grep(prefix_j,colnames(x))
#print(data.frame(prefix=c(prefix_i,prefix_j),coords=c(curr_rows,curr_cols)))
curr_comp<-x[curr_rows,curr_cols]
dist_vect<-c(dist_vect,curr_dist)
}
print(dist_vect)
}
col_names<-c()
for (i in 1:length(run_alifiles)) {
filename<-run_alifiles[i]
print(filename)
curr_ali<-read.FASTA(filename)
x<-as.data.frame(as.matrix(dist.dna(curr_ali,model="JC69")))
print(x[,21])
splitted_filename<-strsplit(filename,split="_")[[1]]
gene_id<-splitted_filename[grep("gene-",splitted_filename)]
col_names<-c(col_names,gene_id)
row_names<-paste(branch_bounds$start,"<->",branch_bounds$end,sep="")
dist_vect<-c()
for (line in 1:nrow(branch_bounds)) {
#curr_ali<-read.FASTA(filename)
prefix_i<-branch_bounds$start[line]
prefix_j<-branch_bounds$end[line]
curr_rows<-grep(prefix_i, rownames(x))
curr_cols<-grep(prefix_j,colnames(x))
#print(data.frame(prefix=c(prefix_i,prefix_j),coords=c(curr_rows,curr_cols)))
curr_comp<-x[curr_rows,curr_cols]
dist_vect<-c(dist_vect,curr_dist)
}
print(dist_vect)
}
col_names<-c()
for (i in 1:length(run_alifiles)) {
filename<-run_alifiles[i]
print(filename)
curr_ali<-read.FASTA(filename)
x<-as.data.frame(as.matrix(dist.dna(curr_ali,model="JC69")))
print(x[,21])
splitted_filename<-strsplit(filename,split="_")[[1]]
gene_id<-splitted_filename[grep("gene-",splitted_filename)]
col_names<-c(col_names,gene_id)
row_names<-paste(branch_bounds$start,"<->",branch_bounds$end,sep="")
dist_vect<-c()
print(dist_vect)
for (line in 1:nrow(branch_bounds)) {
#curr_ali<-read.FASTA(filename)
prefix_i<-branch_bounds$start[line]
prefix_j<-branch_bounds$end[line]
curr_rows<-grep(prefix_i, rownames(x))
curr_cols<-grep(prefix_j,colnames(x))
#print(data.frame(prefix=c(prefix_i,prefix_j),coords=c(curr_rows,curr_cols)))
curr_comp<-x[curr_rows,curr_cols]
dist_vect<-c(dist_vect,curr_dist)
}
print(dist_vect)
}
col_names<-c()
for (i in 1:length(run_alifiles)) {
filename<-run_alifiles[i]
print(filename)
curr_ali<-read.FASTA(filename)
x<-as.data.frame(as.matrix(dist.dna(curr_ali,model="JC69")))
#print(x[,21])
splitted_filename<-strsplit(filename,split="_")[[1]]
gene_id<-splitted_filename[grep("gene-",splitted_filename)]
col_names<-c(col_names,gene_id)
row_names<-paste(branch_bounds$start,"<->",branch_bounds$end,sep="")
dist_vect<-c()
#print(dist_vect)
for (line in 1:nrow(branch_bounds)) {
#curr_ali<-read.FASTA(filename)
prefix_i<-branch_bounds$start[line]
prefix_j<-branch_bounds$end[line]
curr_rows<-grep(prefix_i, rownames(x))
curr_cols<-grep(prefix_j,colnames(x))
#print(data.frame(prefix=c(prefix_i,prefix_j),coords=c(curr_rows,curr_cols)))
curr_comp<-x[curr_rows,curr_cols]
dist_vect<-c(dist_vect,curr_dist)
}
print(dist_vect)
}
col_names<-c()
for (i in 1:length(run_alifiles)) {
filename<-run_alifiles[i]
print(filename)
curr_ali<-read.FASTA(filename)
curr_dists<-as.data.frame(as.matrix(dist.dna(curr_ali,model="JC69")))
#print(x[,21])
splitted_filename<-strsplit(filename,split="_")[[1]]
gene_id<-splitted_filename[grep("gene-",splitted_filename)]
col_names<-c(col_names,gene_id)
row_names<-paste(branch_bounds$start,"<->",branch_bounds$end,sep="")
dist_vect<-c()
#print(dist_vect)
for (line in 1:nrow(branch_bounds)) {
#curr_ali<-read.FASTA(filename)
prefix_i<-branch_bounds$start[line]
prefix_j<-branch_bounds$end[line]
curr_rows<-grep(prefix_i, rownames(curr_dists))
curr_cols<-grep(prefix_j,colnames(curr_dists))
#print(data.frame(prefix=c(prefix_i,prefix_j),coords=c(curr_rows,curr_cols)))
curr_comp<-x[curr_rows,curr_cols]
dist_vect<-c(dist_vect,curr_dist)
}
print(dist_vect)
}
col_names
row_names
run_alifiles
filename1<-run_alifiles[1]
filename2<-run_alifiles[2]
curr_ali1<-read.FASTA(filename1)
curr_ali2<-read.FASTA(filename2)
curr_dists1<-as.data.frame(as.matrix(dist.dna(curr_ali1,model="JC69")))
curr_dists2<-as.data.frame(as.matrix(dist.dna(curr_ali2,model="JC69")))
prefix_vect
col_names<-c()
for (i in 1:length(run_alifiles)) {
filename<-run_alifiles[i]
print(filename)
curr_ali<-read.FASTA(filename)
curr_dists<-as.data.frame(as.matrix(dist.dna(curr_ali,model="JC69")))
#print(x[,21])
splitted_filename<-strsplit(filename,split="_")[[1]]
gene_id<-splitted_filename[grep("gene-",splitted_filename)]
col_names<-c(col_names,gene_id)
row_names<-paste(branch_bounds$start,"<->",branch_bounds$end,sep="")
dist_vect<-c()
#print(dist_vect)
for (line in 1:nrow(branch_bounds)) {
#curr_ali<-read.FASTA(filename)
prefix_i<-branch_bounds$start[line]
prefix_j<-branch_bounds$end[line]
curr_rows<-grep(prefix_i, rownames(curr_dists))
curr_cols<-grep(prefix_j,colnames(curr_dists))
print(curr_rows,curr_cols)
#print(data.frame(prefix=c(prefix_i,prefix_j),coords=c(curr_rows,curr_cols)))
curr_comp<-x[curr_rows,curr_cols]
dist_vect<-c(dist_vect,curr_dist)
}
print(dist_vect)
}
col_names<-c()
for (i in 1:length(run_alifiles)) {
filename<-run_alifiles[i]
print(filename)
curr_ali<-read.FASTA(filename)
curr_dists<-as.data.frame(as.matrix(dist.dna(curr_ali,model="JC69")))
#print(x[,21])
splitted_filename<-strsplit(filename,split="_")[[1]]
gene_id<-splitted_filename[grep("gene-",splitted_filename)]
col_names<-c(col_names,gene_id)
row_names<-paste(branch_bounds$start,"<->",branch_bounds$end,sep="")
dist_vect<-c()
#print(dist_vect)
for (line in 1:nrow(branch_bounds)) {
#curr_ali<-read.FASTA(filename)
prefix_i<-branch_bounds$start[line]
prefix_j<-branch_bounds$end[line]
print(prefix_i,prefix_j)
curr_rows<-grep(prefix_i, rownames(curr_dists))
curr_cols<-grep(prefix_j,colnames(curr_dists))
print(curr_rows,curr_cols)
#print(data.frame(prefix=c(prefix_i,prefix_j),coords=c(curr_rows,curr_cols)))
curr_comp<-x[curr_rows,curr_cols]
dist_vect<-c(dist_vect,curr_dist)
}
print(dist_vect)
}
col_names<-c()
for (i in 1:length(run_alifiles)) {
filename<-run_alifiles[i]
print(filename)
curr_ali<-read.FASTA(filename)
curr_dists<-as.data.frame(as.matrix(dist.dna(curr_ali,model="JC69")))
#print(x[,21])
splitted_filename<-strsplit(filename,split="_")[[1]]
gene_id<-splitted_filename[grep("gene-",splitted_filename)]
col_names<-c(col_names,gene_id)
row_names<-paste(branch_bounds$start,"<->",branch_bounds$end,sep="")
dist_vect<-c()
#print(dist_vect)
for (line in 1:nrow(branch_bounds)) {
#curr_ali<-read.FASTA(filename)
prefix_i<-branch_bounds$start[line]
prefix_j<-branch_bounds$end[line]
#print(prefix_i,prefix_j)
curr_rows<-grep(prefix_i, rownames(curr_dists))
curr_cols<-grep(prefix_j,colnames(curr_dists))
print(curr_rows,curr_cols)
#print(data.frame(prefix=c(prefix_i,prefix_j),coords=c(curr_rows,curr_cols)))
curr_comp<-x[curr_rows,curr_cols]
dist_vect<-c(dist_vect,curr_dist)
}
print(dist_vect)
}
col_names<-c()
for (i in 1:length(run_alifiles)) {
filename<-run_alifiles[i]
print(filename)
curr_ali<-read.FASTA(filename)
curr_dists<-as.data.frame(as.matrix(dist.dna(curr_ali,model="JC69")))
#print(x[,21])
splitted_filename<-strsplit(filename,split="_")[[1]]
gene_id<-splitted_filename[grep("gene-",splitted_filename)]
col_names<-c(col_names,gene_id)
row_names<-paste(branch_bounds$start,"<->",branch_bounds$end,sep="")
dist_vect<-c()
#print(dist_vect)
for (line in 1:nrow(branch_bounds)) {
#curr_ali<-read.FASTA(filename)
prefix_i<-branch_bounds$start[line]
print(prefix_i)
prefix_j<-branch_bounds$end[line]
print(prefix_j)
#print(prefix_i,prefix_j)
curr_rows<-grep(prefix_i, rownames(curr_dists))
curr_cols<-grep(prefix_j,colnames(curr_dists))
print(curr_rows,curr_cols)
#print(data.frame(prefix=c(prefix_i,prefix_j),coords=c(curr_rows,curr_cols)))
curr_comp<-x[curr_rows,curr_cols]
dist_vect<-c(dist_vect,curr_dist)
}
print(dist_vect)
}
col_names<-c()
for (i in 1:length(run_alifiles)) {
filename<-run_alifiles[i]
print(filename)
curr_ali<-read.FASTA(filename)
curr_dists<-as.data.frame(as.matrix(dist.dna(curr_ali,model="JC69")))
#print(x[,21])
splitted_filename<-strsplit(filename,split="_")[[1]]
gene_id<-splitted_filename[grep("gene-",splitted_filename)]
col_names<-c(col_names,gene_id)
row_names<-paste(branch_bounds$start,"<->",branch_bounds$end,sep="")
dist_vect<-c()
#print(dist_vect)
for (line in 1:nrow(branch_bounds)) {
#curr_ali<-read.FASTA(filename)
prefix_i<-branch_bounds$start[line]
print(prefix_i)
prefix_j<-branch_bounds$end[line]
print(prefix_j)
#print(prefix_i,prefix_j)
curr_rows<-grep(prefix_i, rownames(curr_dists))
curr_cols<-grep(prefix_j,colnames(curr_dists))
print(curr_rows,curr_cols)
#print(data.frame(prefix=c(prefix_i,prefix_j),coords=c(curr_rows,curr_cols)))
curr_comp<-x[curr_rows,curr_cols]
dist_vect<-c(dist_vect,curr_comp)
}
print(dist_vect)
}
col_names<-c()
for (i in 1:length(run_alifiles)) {
filename<-run_alifiles[i]
print(filename)
curr_ali<-read.FASTA(filename)
curr_dists<-as.data.frame(as.matrix(dist.dna(curr_ali,model="JC69")))
#print(x[,21])
splitted_filename<-strsplit(filename,split="_")[[1]]
gene_id<-splitted_filename[grep("gene-",splitted_filename)]
col_names<-c(col_names,gene_id)
row_names<-paste(branch_bounds$start,"<->",branch_bounds$end,sep="")
dist_vect<-c()
#print(dist_vect)
for (line in 1:nrow(branch_bounds)) {
#curr_ali<-read.FASTA(filename)
prefix_i<-branch_bounds$start[line]
#print(prefix_i)
prefix_j<-branch_bounds$end[line]
#print(prefix_j)
#print(prefix_i,prefix_j)
curr_rows<-grep(prefix_i, rownames(curr_dists))
curr_cols<-grep(prefix_j,colnames(curr_dists))
#print(curr_rows,curr_cols)
#print(data.frame(prefix=c(prefix_i,prefix_j),coords=c(curr_rows,curr_cols)))
curr_comp<-x[curr_rows,curr_cols]
dist_vect<-c(dist_vect,curr_comp)
}
print(dist_vect)
}
col_names<-c()
for (i in 1:length(run_alifiles)) {
filename<-run_alifiles[i]
print(filename)
curr_ali<-read.FASTA(filename)
curr_dists<-as.data.frame(as.matrix(dist.dna(curr_ali,model="JC69")))
#print(x[,21])
splitted_filename<-strsplit(filename,split="_")[[1]]
gene_id<-splitted_filename[grep("gene-",splitted_filename)]
col_names<-c(col_names,gene_id)
row_names<-paste(branch_bounds$start,"<->",branch_bounds$end,sep="")
dist_vect<-c()
#print(dist_vect)
for (line in 1:nrow(branch_bounds)) {
#curr_ali<-read.FASTA(filename)
prefix_i<-branch_bounds$start[line]
#print(prefix_i)
prefix_j<-branch_bounds$end[line]
#print(prefix_j)
#print(prefix_i,prefix_j)
curr_rows<-grep(prefix_i, rownames(curr_dists))
curr_cols<-grep(prefix_j,colnames(curr_dists))
#print(curr_rows,curr_cols)
#print(data.frame(prefix=c(prefix_i,prefix_j),coords=c(curr_rows,curr_cols)))
curr_comp<-curr_dists[curr_rows,curr_cols]
dist_vect<-c(dist_vect,curr_comp)
}
print(dist_vect)
}
col_names<-c()
for (i in 1:length(run_alifiles)) {
filename<-run_alifiles[i]
print(filename)
curr_ali<-read.FASTA(filename)
curr_dists<-as.data.frame(as.matrix(dist.dna(curr_ali,model="JC69")))
#print(x[,21])
splitted_filename<-strsplit(filename,split="_")[[1]]
gene_id<-splitted_filename[grep("gene-",splitted_filename)]
col_names<-c(col_names,gene_id)
row_names<-paste(branch_bounds$start,"<->",branch_bounds$end,sep="")
dist_vect<-c()
#print(dist_vect)
for (line in 1:nrow(branch_bounds)) {
#curr_ali<-read.FASTA(filename)
prefix_i<-branch_bounds$start[line]
#print(prefix_i)
prefix_j<-branch_bounds$end[line]
#print(prefix_j)
#print(prefix_i,prefix_j)
curr_rows<-grep(prefix_i, rownames(curr_dists))
curr_cols<-grep(prefix_j,colnames(curr_dists))
#print(curr_rows,curr_cols)
#print(data.frame(prefix=c(prefix_i,prefix_j),coords=c(curr_rows,curr_cols)))
curr_comp<-mean(c(curr_dists[curr_rows,curr_cols],recursive=T))
dist_vect<-c(dist_vect,curr_comp)
}
print(dist_vect)
}
col_names<-c()
for (i in 1:length(run_alifiles)) {
filename<-run_alifiles[i]
curr_ali<-read.FASTA(filename)
curr_dists<-as.data.frame(as.matrix(dist.dna(curr_ali,model="JC69")))
splitted_filename<-strsplit(filename,split="_")[[1]]
gene_id<-splitted_filename[grep("gene-",splitted_filename)]
col_names<-c(col_names,gene_id)
row_names<-paste(branch_bounds$start,"<->",branch_bounds$end,sep="")
dist_vect<-c()
for (line in 1:nrow(branch_bounds)) {
prefix_i<-branch_bounds$start[line]
prefix_j<-branch_bounds$end[line]
curr_rows<-grep(prefix_i, rownames(curr_dists))
curr_cols<-grep(prefix_j,colnames(curr_dists))
curr_comp<-mean(c(curr_dists[curr_rows,curr_cols],recursive=T))
dist_vect<-c(dist_vect,curr_comp)
}
print(dist_vect)
}
col_names<-c()
for (i in 1:length(run_alifiles)) {
filename<-run_alifiles[i]
curr_ali<-read.FASTA(filename)
curr_dists<-as.data.frame(as.matrix(dist.dna(curr_ali,model="JC69")))
splitted_filename<-strsplit(filename,split="_")[[1]]
gene_id<-splitted_filename[grep("gene-",splitted_filename)]
col_names<-c(col_names,gene_id)
row_names<-paste(branch_bounds$start,"<->",branch_bounds$end,sep="")
dist_vect<-c()
for (line in 1:nrow(branch_bounds)) {
prefix_i<-branch_bounds$start[line]
prefix_j<-branch_bounds$end[line]
curr_rows<-grep(prefix_i, rownames(curr_dists))
curr_cols<-grep(prefix_j,colnames(curr_dists))
curr_comp<-mean(c(curr_dists[curr_rows,curr_cols],recursive=T))
dist_vect<-c(dist_vect,curr_comp)
}
if (i == 1) {
result<-data.frame(V1=dist_vect)
} else {
result<-cbind(result,dist_vect)
}
}
result
ncol(result)
col_names<-c()
for (i in 1:length(run_alifiles)) {
filename<-run_alifiles[i]
curr_ali<-read.FASTA(filename)
curr_dists<-as.data.frame(as.matrix(dist.dna(curr_ali,model="JC69")))
splitted_filename<-strsplit(filename,split="_")[[1]]
gene_id<-splitted_filename[grep("gene-",splitted_filename)]
col_names<-c(col_names,gene_id)
row_names<-paste(branch_bounds$start,"<->",branch_bounds$end,sep="")
dist_vect<-c()
for (line in 1:nrow(branch_bounds)) {
prefix_i<-branch_bounds$start[line]
prefix_j<-branch_bounds$end[line]
curr_rows<-grep(prefix_i, rownames(curr_dists))
curr_cols<-grep(prefix_j,colnames(curr_dists))
curr_comp<-mean(c(curr_dists[curr_rows,curr_cols],recursive=T))
dist_vect<-c(dist_vect,curr_comp)
}
if (i == 1) {
result<-data.frame(V1=dist_vect)
} else {
result<-cbind(result,dist_vect)
}
}
colnames(result)<-col_names
rownames(result)<-row_names
result
plot(result)
?plot
result
png(file="Run_999_blengths.png")
plot(result)
dev.off()
?plot
png(file="Run_999_blengths.png")
plot(result,type="l")
?plot
?plot
plot(result,type="l")
plot(result,type="l")
plot(result,"l")
dev.off()
png(file="Run_999_blengths.png")
plot(result,"l")
dev.off()
png(file="Run_999_blengths.png")
plot(result$gene-0,"l")
result$x
result$gene-0
result
result$gene-0
result[1,]
png(file="Run_999_blengths.png")
plot(result[1,],"l")
dev.off()
